---
import { getCollection, getEntry } from "astro:content";

import { getHumanReadableScriptureRef } from "@src/utils/bibleParser";

import Header from "@components/Header.astro";
import BaseLayout from "@layouts/BaseLayout.astro";
import SpotifyAudioEmbed from "@components/SpotifyAudioEmbed.astro";

const allSermons = await getCollection("sermons");
const { id: latestSermonID, data: latestSermon } = allSermons.sort(
  (a, b) => b.data.date.valueOf() - a.data.date.valueOf(),
)[0];

console.log(latestSermon);

const series = latestSermon.series.match(/[a-z0-9-]*.(?=.md$)/)!;
console.log(series[0]);

const latestSermonSeriesEntry = await getEntry("sermonSeries", series[0]);

console.log(latestSermonSeriesEntry);

const allSeries = await getCollection("sermonSeries");
allSeries.sort(
  (a, b) => b.data.startDate.valueOf() - a.data.startDate.valueOf(),
);

const allPreachers = await getCollection("preachers");
---

<BaseLayout>
  <Header />
</BaseLayout>
